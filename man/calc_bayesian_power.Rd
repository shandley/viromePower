% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_bayesian_power.R
\name{calc_bayesian_power}
\alias{calc_bayesian_power}
\title{Calculate Bayesian Power for Virome Studies}
\usage{
calc_bayesian_power(
  n_samples,
  effect_size,
  n_viruses,
  sparsity = 0.7,
  dispersion = 1.2,
  prior_strength = 2,
  credible_interval = 0.95,
  fold_change_threshold = 1.5,
  posterior_prob_threshold = 0.95,
  n_sim = 100,
  seed = NULL,
  suppress_warnings = FALSE
)
}
\arguments{
\item{n_samples}{Number of samples per group}

\item{effect_size}{Expected effect size (fold change between groups)}

\item{n_viruses}{Number of viral taxa to simulate}

\item{sparsity}{Proportion of zeros in the count matrix (default: 0.7)}

\item{dispersion}{Dispersion parameter for negative binomial distribution (default: 1.2)}

\item{prior_strength}{Prior strength (concentration) parameter (default: 2)}

\item{credible_interval}{Width of the credible interval for decision threshold (default: 0.95)}

\item{fold_change_threshold}{Minimum fold change to consider biologically relevant (default: 1.5)}

\item{posterior_prob_threshold}{Posterior probability threshold for significance (default: 0.95)}

\item{n_sim}{Number of simulation iterations (default: 100)}

\item{seed}{Random seed for reproducibility (default: NULL)}

\item{suppress_warnings}{Whether to suppress warnings during calculation (default: FALSE)}
}
\value{
A list containing:
\itemize{
\item power: Estimated Bayesian power (probability of detecting true effect)
\item expected_discoveries: Expected number of discoveries (true positives)
\item false_discovery_proportion: Expected proportion of false discoveries
\item bayes_factor_summary: Summary statistics of Bayes factors from simulations
\item posterior_prob_summary: Summary of posterior probabilities from simulations
\item simulation_results: Detailed simulation results for each iteration
\item parameters: List of input parameters
}
}
\description{
This function performs Bayesian power analysis for virome studies comparing two groups.
It uses simulation-based methods to estimate the probability of detecting true effects
under a Bayesian framework, which can be more appropriate for sparse, high-dimensional
virome data than traditional frequentist approaches.
}
\examples{
# Calculate Bayesian power for a virome study
power_result <- calc_bayesian_power(
  n_samples = 20,         # 20 samples per group
  effect_size = 3.0,      # 3-fold difference between groups
  n_viruses = 50,         # 50 viral taxa
  sparsity = 0.6,         # 60\% zeros in the data
  prior_strength = 2.5,   # Moderate prior strength
  n_sim = 50              # 50 simulation iterations
)

# Print the Bayesian power estimate
print(paste("Bayesian power:", round(power_result$power * 100, 1), "\%"))

# Print the expected number of discoveries
print(paste("Expected discoveries:", round(power_result$expected_discoveries, 1)))

# Generate a Bayesian power report
report_path <- generate_bayesian_power_report(
  bayesian_power_results = power_result,
  output_file = "bayesian_power_report.html",
  title = "Bayesian Power Analysis for Virome Study"
)

}
