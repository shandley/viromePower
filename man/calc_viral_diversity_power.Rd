% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_viral_diversity_power.R
\name{calc_viral_diversity_power}
\alias{calc_viral_diversity_power}
\title{Calculate Power for Viral Diversity Analysis}
\usage{
calc_viral_diversity_power(
  n_samples,
  effect_size,
  n_viruses,
  alpha = 0.05,
  sparsity = 0.8,
  dispersion = 2,
  diversity_measure = "shannon",
  n_sim = 100
)
}
\arguments{
\item{n_samples}{Number of samples per group}

\item{effect_size}{Expected effect size (for alpha diversity: Cohen's d, for beta: PERMANOVA R2)}

\item{n_viruses}{Number of viral taxa in the dataset}

\item{alpha}{Significance level (default: 0.05)}

\item{sparsity}{Proportion of zeros in the data (default: 0.8)}

\item{dispersion}{Dispersion parameter for viral abundance (default: 2)}

\item{diversity_measure}{Type of diversity to analyze: "shannon", "simpson", "richness", "evenness", "chao1", "ace", "inv_simpson", "fisher_alpha", "goods_coverage", "berger_parker", "bray", "jaccard", "sorensen", "morisita_horn", "ruzicka", "cca" (default: "shannon")}

\item{n_sim}{Number of simulations for Monte Carlo estimation (default: 100)}
}
\value{
A list containing power estimates, simulation results, and parameters
}
\description{
Calculates statistical power for detecting differences in alpha and beta diversity
measures between groups in a virome study, using simulation-based approach.
}
\examples{
# Calculate power for Shannon diversity
power_shannon <- calc_viral_diversity_power(n_samples = 15, effect_size = 1.2, 
                                           n_viruses = 200, diversity_measure = "shannon")
                                           
# Calculate power for Chao1 richness estimator
power_chao1 <- calc_viral_diversity_power(n_samples = 15, effect_size = 1.2,
                                         n_viruses = 200, diversity_measure = "chao1")
 
# Calculate power for Good's coverage estimator
power_coverage <- calc_viral_diversity_power(n_samples = 15, effect_size = 1.2,
                                          n_viruses = 200, diversity_measure = "goods_coverage")

# Calculate power for Berger-Parker dominance index
power_bp <- calc_viral_diversity_power(n_samples = 15, effect_size = 1.0,
                                     n_viruses = 200, diversity_measure = "berger_parker")
                                          
# Calculate power for beta diversity (Bray-Curtis)
power_bray <- calc_viral_diversity_power(n_samples = 20, effect_size = 0.15, 
                                       n_viruses = 300, diversity_measure = "bray")
                                       
# Calculate power for SÃ¸rensen index (presence/absence)
power_sorensen <- calc_viral_diversity_power(n_samples = 25, effect_size = 0.2,
                                           n_viruses = 200, diversity_measure = "sorensen")
                                           
# Calculate power for Morisita-Horn index (abundance-weighted similarity)
power_morisita <- calc_viral_diversity_power(n_samples = 20, effect_size = 0.2,
                                           n_viruses = 150, diversity_measure = "morisita_horn")
}
