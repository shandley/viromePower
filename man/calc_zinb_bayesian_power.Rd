% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_zinb_bayesian_power.R
\name{calc_zinb_bayesian_power}
\alias{calc_zinb_bayesian_power}
\title{Calculate Zero-Inflated Bayesian Power for Virome Studies}
\usage{
calc_zinb_bayesian_power(
  n_samples,
  effect_size,
  n_viruses,
  structural_zeros = 0.7,
  sampling_zeros = 0.2,
  dispersion = 1.5,
  zero_inflation_difference = TRUE,
  prior_strength = 2,
  credible_interval = 0.95,
  fold_change_threshold = 1.5,
  posterior_prob_threshold = 0.95,
  n_sim = 100,
  seed = NULL,
  suppress_warnings = FALSE,
  diversity_analysis = FALSE,
  diversity_metrics = c("shannon", "simpson")
)
}
\arguments{
\item{n_samples}{Number of samples per group}

\item{effect_size}{Expected effect size (fold change between groups)}

\item{n_viruses}{Number of viral taxa to simulate}

\item{structural_zeros}{Proportion of structural zeros (true absence) in the data (default: 0.7)}

\item{sampling_zeros}{Proportion of sampling zeros (detection failures) among non-structural zeros (default: 0.2)}

\item{dispersion}{Dispersion parameter for negative binomial distribution (default: 1.5)}

\item{zero_inflation_difference}{Whether the zero-inflation probability differs between groups (default: TRUE)}

\item{prior_strength}{Prior strength (concentration) parameter (default: 2)}

\item{credible_interval}{Width of the credible interval for decision threshold (default: 0.95)}

\item{fold_change_threshold}{Minimum fold change to consider biologically relevant (default: 1.5)}

\item{posterior_prob_threshold}{Posterior probability threshold for significance (default: 0.95)}

\item{n_sim}{Number of simulation iterations (default: 100)}

\item{seed}{Random seed for reproducibility (default: NULL)}

\item{suppress_warnings}{Whether to suppress warnings during calculation (default: FALSE)}

\item{diversity_analysis}{Whether to include Bayesian analysis of alpha diversity (default: FALSE)}

\item{diversity_metrics}{Character vector of alpha diversity metrics to analyze (default: c("shannon", "simpson"))}
}
\value{
A list containing:
\itemize{
\item power: Estimated Bayesian power (probability of detecting true effect)
\item expected_discoveries: Expected number of discoveries (true positives)
\item false_discovery_proportion: Expected proportion of false discoveries
\item bayes_factor_summary: Summary statistics of Bayes factors from simulations
\item posterior_prob_summary: Summary of posterior probabilities from simulations
\item simulation_results: Detailed simulation results for each iteration
\item parameters: List of input parameters
\item diversity_results: If diversity_analysis=TRUE, Bayesian analysis of alpha diversity metrics
\item zero_inflation_summary: Summary statistics related to zero-inflation modeling
}
}
\description{
This function performs Bayesian power analysis for virome studies using a zero-inflated negative
binomial (ZINB) model, which is particularly suitable for viral metagenomic data with excess zeros.
The analysis accounts for both structural zeros (true absence) and sampling zeros (detection failures),
providing more accurate power estimates for datasets with extreme sparsity.
}
\examples{
# Calculate zero-inflated Bayesian power for a virome study
zinb_power <- calc_zinb_bayesian_power(
  n_samples = 30,           # 30 samples per group
  effect_size = 2.5,        # 2.5-fold difference between groups
  n_viruses = 200,          # 200 viral taxa
  structural_zeros = 0.75,  # 75\% structural zeros (true absence)
  sampling_zeros = 0.15,    # 15\% sampling zeros (detection failures)
  n_sim = 20                # 20 simulation iterations
)

# Print the Bayesian power estimate
print(paste("ZINB Bayesian power:", round(zinb_power$power * 100, 1), "\%"))

}
