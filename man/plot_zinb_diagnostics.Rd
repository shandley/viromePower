% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_zero_inflated_models.R
\name{plot_zinb_diagnostics}
\alias{plot_zinb_diagnostics}
\title{Plot Zero-Inflated Negative Binomial Model Diagnostics}
\usage{
plot_zinb_diagnostics(
  obs_data,
  zinb_model_fit,
  n_taxa_to_plot = 4,
  seed = NULL
)
}
\arguments{
\item{obs_data}{A matrix or data frame containing the observed count data with
samples as rows and taxa as columns.}

\item{zinb_model_fit}{A fitted zero-inflated model object or a list containing
model parameters (mu, size, zi_prob).}

\item{n_taxa_to_plot}{Integer specifying the number of randomly selected taxa to
show in detailed plots (default: 4).}

\item{seed}{Optional random seed for reproducible taxa selection.}
}
\value{
A list of ggplot2 objects with different diagnostic plots.
}
\description{
Creates diagnostic plots for assessing the fit of zero-inflated negative binomial models
to observed virome data.
}
\examples{
\dontrun{
# Simulate zero-inflated data
sim_data <- simulate_zero_inflated_virome(
  n_samples = 50,
  n_taxa = 100,
  mu = 10,
  size = 0.5,
  zi_prob = 0.3,
  group_effect = 1.5,
  group_factor = rep(c("A", "B"), each = 25)
)

# Assume we've fit a ZINB model and have parameter estimates
zinb_fit <- list(
  mu = matrix(rgamma(50*100, 5, 0.5), nrow = 50),
  size = 0.5,
  zi_prob = matrix(rbeta(50*100, 2, 5), nrow = 50)
)

# Create diagnostic plots
diagnostics <- plot_zinb_diagnostics(
  obs_data = sim_data$counts,
  zinb_model_fit = zinb_fit,
  n_taxa_to_plot = 6,
  seed = 123
)

# Display the plots
diagnostics$zero_proportion_plot
diagnostics$qq_plot
diagnostics$taxa_fit_plots
}

}
