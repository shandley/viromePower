% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_zero_inflated_virome.R
\name{simulate_zero_inflated_virome}
\alias{simulate_zero_inflated_virome}
\title{Simulate Zero-Inflated Virome Data}
\usage{
simulate_zero_inflated_virome(
  n_samples,
  n_viruses,
  structural_zeros = 0.7,
  sampling_zeros = 0.2,
  dispersion = 1.5,
  effect_size = 2,
  zero_inflation_difference = TRUE,
  groups = NULL,
  variable_zi_rates = FALSE,
  zi_alpha = 2,
  zi_beta = 3
)
}
\arguments{
\item{n_samples}{Number of samples to simulate}

\item{n_viruses}{Number of viral taxa to simulate}

\item{structural_zeros}{Proportion of structural zeros (true absence) in the data (default: 0.7)}

\item{sampling_zeros}{Proportion of sampling zeros (detection failures) among non-structural zeros (default: 0.2)}

\item{dispersion}{Dispersion parameter for negative binomial distribution (default: 1.5)}

\item{effect_size}{Effect size for group differences (default: 2.0)}

\item{zero_inflation_difference}{Whether the zero-inflation probability differs between groups (default: TRUE)}

\item{groups}{Vector of group labels for samples (default: equal groups)}

\item{variable_zi_rates}{Logical; whether to use varying zero inflation rates across viral taxa (default: FALSE)}

\item{zi_alpha}{Shape parameter for beta distribution to generate variable structural zero rates (default: 2)}

\item{zi_beta}{Shape parameter for beta distribution to generate variable structural zero rates (default: 3)}
}
\value{
A list containing simulated count matrix and sample metadata, with additional
information about the zero-inflation structure
}
\description{
Generates simulated virome data using a zero-inflated negative binomial (ZINB) model,
which is particularly suitable for viral metagenomic data with excess zeros beyond
what would be expected from a standard negative binomial distribution. The ZINB model
combines a point mass at zero with a negative binomial distribution, allowing for
modeling of structural zeros (true absence) and sampling zeros (detection failures).
}
\examples{
# Basic zero-inflated simulation
sim_data <- simulate_zero_inflated_virome(n_samples = 30, n_viruses = 100)

# Simulation with varying zero-inflation rates across viral taxa
sim_data_var <- simulate_zero_inflated_virome(
  n_samples = 30, 
  n_viruses = 100,
  variable_zi_rates = TRUE,
  zi_alpha = 2,
  zi_beta = 5  # More right-skewed distribution of zi rates
)
}
